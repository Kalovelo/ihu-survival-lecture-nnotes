# Μεταγωγείς Πακέτου & Κυκλώματος

## Μεταγωγείς πακέτων

> Σε μια αποστολή μηνύματος μεταξύ 2 τερματικών, το τερματικό προέλευσης διαιρεί τα μεγάλα μηνύματα σε μικρότερα κομμάτια δεδομένων

- Τα κομμάτια δεδομένων ονομάζονται **πακέτα (packets)**
- Κάθε πακέτο, ταξιδεύει μέσω ζεύξεων επικοινωνίας και **μεταγωγών πακέτων (packet switches)**
- οι μεταγωγείς πακέτων χωρίζονται σε 2 κατηγορίες
  - **Δρομολογητές (routers)**
  - **Μεταγωγείς επιπέδου ζεύξης (Link-layer switches)**
- Τα πακέτα μεταδίδονται μέσω κάθε ζεύξης με ένα ρυθμό ίσο με τον πλήρη ρυθμό μετάδοσης ζεύξης.

### Μετάδοση Αποθήκευσης-και-Προώθησης

> Ο μεταγωγός πρέπει να παραλάβει **ολόκληρο** το πακέτο πριν αρχίσει να το μεταδίδει το πρώτο bit του πακέτου στη ζεύξη προορισμού

### Καθυστέρηση ουράς και Απώλεια πακέτου

> Κάθε μεταγωγός πακέτου έχει συνδεδεμένες πολλαπλές ζεύξεις.

Για κάθε τέτοια ζεύξη, ο μεταγωγός έχει έναν **ενταμιευτή εξόδου (output buffer)** ή **ουρά εξόδου (output queue)** για την αποθήκευση πακέτων ως προς αποστολή τους από το δρομολογητή.

Αν ένα πακέτο προς μετάδοση βρει τη ζεύξη απασχολημένη, με τη μετάδοση ενός άλλου πακέτου, **το πακέτο πρέπει να περιμένει.** Αυτή η αναμονή ονομάζεται **καθυστέρηση ουράς (queue delay)** του ενταμιευτή εξόδου.

Στην περίπτωση που ένας ενταμιευτής είναι γεμάτος, ένα νέο πακέτο προς αναμονή θα χαθεί, εφόσον δεν χωράει, δηλαδή θα έχουμε **απώλεια πακέτου (packet loss)**

### Πίνακας Προώθησης

Όταν ένα πακέτο φθάνει σε ένα δρομολογητή μέσα στο δίκτυο, ο δρομολογητής εξετάζει ένα τμήμα διευθύνσεως προορισμού του πακέτου και προωθεί το πακέτο σε ένα γειτονικό δρομολογητή. Συγκεκριμένα, κάθε δρομολογητής έχει έναν πίνακα προώθησης (forwarding table) με εξερχόμενες ζεύξεις. Όταν ένα πακέτο φθάνει, ο δρομολογητής εξετάζει τη διεύθυνση και ψάχνει στον πίνακα για να βρει την κατάλληλη ζεύξη έτσι ώστε το πακέτο να φθάσει στον τελικό προορισμό.

> Θέλω να πάω Αθήνα από Θεσσαλονίκη, αλλά δεν γνωρίζω την πορεία. Θα ρωτήσω κάποιον στη Θεσσαλονίκη, θα με στείλει Λάρισα. Στη Λάρισα θα ρωτήσω κάποιον και θα με στείλει Χαλκίδα. Από εκεί, θα ρωτήσω κάποιον και θα με στείλει στον τελικό προορισμό.

### Το βασικό πρόβλημα των πακέτων

Θεωρούνται μη κατάλληλα για υπηρεσίες πραγματικού χρόνου (τηλέφωνο) λόγω των μεταβλητών και απρόβλεπτων καθυστερήσεων.

## Μεταγωγείς Κυκλώματος 
 
Στα δίκτυα μεταγωγής κυκλώματος, οι επικοινωνίας πόροι που χρειάζονται **δεσμεύονται** κατά τη διάρκεια της επικοινωνίας. 

> Στα δίκτυα μεταγωγής πακέτων, οι πόροι δεν δεσμεύονται: χρησιμοποιούνται κατά απαίτηση, με αποτέλεσμα συχνά να χρειάζεται να περιμένουν.

> Αναλογία Εμπορίου: Έχουμε 2 εστιατόρια, στο Α πρέπει να μπεις στον κόπο να κλείσεις ραντεβού πριν πας να φας (Μεταγωγός Κυκλώματος) και σε ένα άλλο πας καρφί, αν βρεις τραπέζι κάθεσαι κατευθείαν, αλλιώς στέκεσαι όρθιος μέχρι να αδειάσει κάποιο (Μεταγωγός Πακέτων)

- Πριν μπορέσει ο αποστολέας να στείλει τις πληροφορίες, το δίκτυο πρέπει **πρώτα να αποκαταστήσει μια σύνδεση** μεταξύ αποστολέα - παραλήπτη, ονόματι **Κύκλωμα (circuit)**
- Με τη σύνδεση, το κύκλωμα **διατηρεί ένα σταθερό ρυθμό μετάδοσης στις ζεύξεις**
- Έχοντας σταθερό ρυθμό και σύνδεση, ο αποστολέας έχει **εγγύηση** στο ρυθμό μεταφοράς

### Πολύπλεξη σε Δίκτυα Μεταγωγής Κυκλώματος

#### Πολύπλεξη FDM

Το φάσμα συχνοτήτων μιας ζεύξης μοιράζεται ανάμεσα στις συνδέσεις που έχουν εγκαθιδρυθεί μέσω της ζεύξης. Η ζεύξη αφιερώνει μια ζώνη συχνοτήτων σε κάθε σύνδεση για τη διάρκεια της σύνδεσης. Το πλάτος της ζώνης ονομάζεται **εύρος ζώνης (bandwidth)** 

> Οι ραδιοφωνικοί σταθμοί χρησιμοποιούν FDM.


#### Πολύπλεξη TDM

- Ο **χρόνος** διαιρείται σε **πλαίσια σταθερής διάρκειας**
- Κάθε πλαίσιο διαιρείται σε ένα **σταθερό αριθμό χρονοθυρίδων.**

Όταν ένα δίκτυο εγκαθιδρύει μια σύνδεση επάνω σε μια ζεύξη, το δίκτυο αφιερώνει **μια χρονοθυρίδα σε κάθε πλαίσιο** για αυτή την σύνδεση. Κάθε χρονοθυρίδα αφιερώνεται για την μετάδοση δεδομένων της σύνδεσης.

Ο ρυθμός μετάδοσης ενός κυκλώματος είναι ίσος με το ρυθμό πλαισίου επί τον αριθμό των bit μέσα σε μια θυρίδα.

#### Διαφορές TDM / FDM

|                            FDM                            |                                                  TDM                                                  |
| :-------------------------------------------------------: | :---------------------------------------------------------------------------------------------------: |
| Κάθε κύκλωμα παίρνει συνεχώς **ένα κλάσμα εύρους ζώνης.** | Κάθε κύκλωμα παίρνει περιοδικά **ολόκληρο το εύρος ζώνης** σε μικρά χρονικά διαστήματα (χρονοθυρίδες) |


## Γιατί είναι τούμπανα τα Πακέτα σε σχέση με τα Κυκλώματα

- Τα Κυκλώματα, δεσμεύουν τους πόρους εκ των προτέρων, ακόμη και αν δεν χρησιμοποιηθούν πλήρως.
- Τα πακέτα λειτουργούν κατά απαίτηση με αποτέλεσμα να είναι πολύ πιο **αποδοτικά**.
- Είναι **απλούστερα** και **φθηνότερα**.