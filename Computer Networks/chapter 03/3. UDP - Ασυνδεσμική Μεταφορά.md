# UDP - Ασυνδεσμική Μεταφορά

Όπως είδαμε και σε προηγούμενα κεφάλαια, το UDP κάνει τα λιγότερα που μπορεί ως πρωτόκολλο μεταφοράς. Έχει μόνο
1. τη λειτουργία πολύπλεξη/αποπολύπλεξη 
2. Ένα ελαφρύ έλεγχο σφάλματος.

>Δεν προσθέτει κάτι στο IP. Λέγεται ασυνδεσμικό γιατί δεν υπάρχει χειραψία ανάμεσα στις οντότητες αποστολής και λήψης.

## Μπονουσάκια UDP σε εφαρμογές Πραγματικού χρόνου

1. **Καλύτερος έλεγχος επιπέδου εφαρμογής** σε ότι αφορά το ποια δεδομένα στέλνονται και πότε. Μόλις μια διεργασία εφαρμογ περάσει τα δεδομένα στο UDP, αυτό συσκευάζει τα δεδομένα μεα σε ένα segment και **αμέσως** θα το σουτάρει στο **επίπεδο δικτύου**. Αντίθετα, λόγω των **μηχανισμών ελέγχου του TCP**, σε περίπτωση σφάλματος, θα στέλνεται **συνεχώς** το segment μέχρι να γίνει **επιτυχής** αποστολή. Σε **εφαρμογές πραγματικού χρόνου**, προτιμούμε μια μικρή απώλεια δεδομένων σε σχέση με μεγαλύτερες καθυστερήσεις.
2. **Μη εγκαθίδρυση Σύνδεσης.** Το TCP χρησιμοποιεί την τριμερή χειραψία πριν αρχίσει τη μεταφορά δεδομένων. Αυτό, εισάγει μια **καθυστέρηση** η οποία **δεν υπάρχει στο UDP.**
3. **Ανύπαρκτη Κατάσταση Σύνδεσης**. Το **TCP** διατηρεί κατάσταση σύνδεσης στα τερματικά συστήματα. Δηλαδή **δεσμεύει** ενταμιευτές αποστολής και λήψης, παραμέτρους ελέγχου συμφόρησης και παραμέτρους αριθμών ακολουθίας και επιβεβαίωσης. Αντίθετα, αυτές οι δεσμεύσεις δεν υπάρχουν στο UDP με αποτέλεσμα ένας server να υποστηρίζει **περισσότερους ενεργούς πελάτες** για μια εφαρμογή.
4. Μικρή καθυστέρηση κεφαλίδας πακέτου. Το TCP παίζει με κεφαλίδα 20 byte σε αντίθεση με το UDP όπου έχουμε **8 byte.**

Γενικά το UDP παίζει σε εφαρμογές πραγματικού χρόνου και πολυμέσων. Βέβαια, η έλλειψη ελέγχου συμφόρησης του UDP μπορεί να προκαλέσει υψηλούς ρυθμούς απωλειών ανάμεσα σε αποστολέα-παραλήπτη. Λόγου χάρη, η ταυτόχρονη αποστολή βίνδεο.

Βέβαια, μπορεί να γίνει αξιόπιστη η μεταφορά δεδομένων προσθέτοντας μηχανισμούς επιβεβαίωσης και αναμετάδοσης στην εφαρμογή.

## Δομή UDP segment

Η κεφαλίδα UDP έχει **4 πεδία**, όπου το καθένα έχει μέγεθος **2 byte**.
1. Αριθμός θύρας προορισμού
2. Αριθμός θύρας προέλευσης
3. Πεδίο μήκους - Μήκος τμήματος UDP σε byte (κεφαλίδα + δεδομένα), χρησιμοποιείται για έλεγχο σφαλμάτων
4. Άθροισμα Ελέγχου

## Άθροισμα Ελέγχου - CHECKSUM

Παρέχει έλεγχο σφαλμάτων. Ελέγχει α κάποιοα bit μέσα στο segment έχουν αλλαχθεί. 
- Βρίσκει το **1-συμπληρωμα** του **αθροίσματος όλων των λέξεων 16-bit** μέσα στο τμήμα και έαν βρεθεί κάποια υπερχείλιση κατά τη διάρκεια υπολογισμού του αθροίσματος στην άλλη πλευρά, αυτή **προστίθεται** στο λιγότερο σημαντικό bit (το τέρμα αριστερά).

### Παράδειγμα

Έστω 3 λέξεις

0110011001100000  
0101010101010101  
1000111100001100

Το άθροισμα των πρώτων 2 είναι

0110011001100000  
0101010101010101  
________________
1011101110110101

Προσθέτουμε την τρίτη λέξη και έχουμε:  

1011101110110101  
1000111100001100
________________
01001010110000**10**

Η τελευταία πρόσθεση είχε υπερχείλιση, η οποία προστέθηκε στο τέλος. Το 1-συμπλήρωμα του τελευταίου αθροίσματος είναι:  

1011010100111101

το οποίο ονομάζεται **άθροισμα ελέγχου**.

Εάν δεν έχουν εισαχθεί σφάλματα στο πακέτο, τότε το άθροισμα στον παραλήπτη θα είναι   

1111111111111111

Αλλιώς, **αν κάποιο bit είναι 0, τότε έχει υπάρξει σφάλμα.**

## Αρχή από-άκρο-σε-άκρο (end-end principle)

 Το UDP παρέχει άθροισμα ελέγχου γιατί **δεν υπάρχει εγγύηση** ότι όλες οι ζεύξεις ανάμεσα σε μία επικοινωνία **παρέχουν έλεγχο σφαλμάτων**. Επίσης,αν τα τμήματα μεταφέρονται σωστά επάνω στη ζεύξη, είναι πιθανό να **εισαχθούν bit σφάλματος** όταν ένα τμήμα αποθηκεύετεται στην μνήμη δρομολογητή.

 Η Αρχή από-άκρο-σε-άκρο ορίζεται ως:

 Εφόσον πρέπει να υλοποιηθεί μια λειτουργικότητα από-άκρο-σε-άκρο, **λειτορυγίες που τοποθετούνται σε κατώτερα επίπεδα μπορούν να είναι πλεονάζουσες ή μικρής αξίας σε σύγκριση με το  κόστος παροχής τους σε υψηλότερο επίπεδο.**

 Επειδή το IP εκτελείται σε σχεδόν οποιοδήποτε πρωτόκολλο επιπέδου μεταφοράς, είναι χρήσιμο το τελευταίο να παρέχει έλεγχο σφαλμάτων. το UDP, ακόμη και αν ελέγχει σφάλματα, **δεν κάνει τίποτα για να ανακάμψει ένα σφάλμα**. Τις περισσότερες φορές, απλά απορρίποτουν το κατεστραμμένο τμήμα ή το περνούν με προειδοποίηση.