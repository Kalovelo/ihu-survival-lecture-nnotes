# Πολύπλεξη και Αποπολύπλεξη

> Γνωρίζουμε ότι μια διεργασία έχει +1 **sockets** μέσω των οποίων **περνούν δεδομένα** από το δίκτυο προς τη διεργασία και αντίστροφα. Άρα ο υπολογιστής λήψης **δεν παραδίδει δεδομένα απ' ευθείας** σε μια διεργασία, αλλά σε socket. 

## Πολύπλεξη
Είναι η εργασία συλλογής δεδομένων στον υπολογιστή προέλευσης από διαφορετικές sockets και η έπειτα ενθυλάκωση κάθε ομάδας δεδομένων με δημιουργία κεφαλίδες πληροφορίας και η μεταβίβαση τους στο επίπεδο δικτύου.

Η πολύπλεξη επίσης απαιτεί οι sockets να έχουν **μοναδικές ταυτότητες** και κάθε τήμα να έχει ειδικά πεδία για την socket προορισμό. Ονομαστικά:
1. Πεδίο Αριθμός θύρας **προέλευσης**
2. Πεδίο αριθμού θύρας **προορισμού**

## Αποπολύπλεξη 
Κάθε τμήμα μεταφοράς έχει ένα σύνολο πεδίων στο τμήμα. Στο άκυρο λήψης, το επίπεδο μεταφοράς τα **εξετάζει για να ταυτοποιήσει τη socket λήψης και να μεταβιβάσει σε αυτή το τμήμα.**

Κάθε socket μπορεί να πάρει ένα αριθμό θύρας. Όταν ένα τμήμα φθάνει στον Η/Υ, το επίπεδο μεταφοράς εξετάζει τον αριθμό θύρας μέσα στο τμήμα και κατευθύνει το τμήμα προς την αντίστοιχη socket.

## Ασυνδεσμική Πολύπλεξη και Αποπολύπλεξη (UDP)

Έστω 2 Η/Υ Α και Β.

Το επίπεδο μεταφοράς στον Α δημιουργεί ένα τμήμα επιπέδου μεταφοράς, που περιλαμβάνει πέρα από τα δεδομένα της εφαρμογής και
1. το port number προέλευσης
2. το port number προορισμού

Έπειτα, το επίπεδο μεταφοράς περνά το τμήμα στο επίπεδο δικτύου όπου το τελευταίο ενθυλακώνει το τμήμα σε ένα δεδομενόγραμμα IP και κάνει τη βέλτιστη προσπάθεια αποστολής.

Το UDP ταυτοποιείται μόνο με την παραπάνω λίστα (1-2). Αν όμως, 2 τμήματα έχουν διαφορετικές IP προέλευσης και ίδιες IP προορισμού και το ίδιο port  προορισμού τότε τα δύο τμήματα θα κατευθύνονται **στην ίδια διεργασία προορισμού** μέσω της **ίδιας socket προορισμού**.

## Συνδεσμική Πολύπλεξη και Αποπολύπλεξη (TCP)

Αντίθετα, το TCP ταυτοποιείται με μια τετράδα

1. το port number προέλευσης
2. το port number προορισμού
3. IP προορισμού
4. IP προέλευσης

Η οποία αποτρέπει το πρόβλημα που αναφέρεται στην ασυνδεσμική προσέγγιση. 

Όταν εκκινείται μια σύνδεση TCP, τότε το επίπεδο εφαρμογ στο server σημειώνει τις παραπάνω 4 τιμές. Έπειτα δημιουργεί μια socket που ταυτοποιείται με αυτές τις τιμές. Όλα τα τμήματα που θα έχουν αυτές τις 4 τιμές θα αποπλέκονται και θα στέλνονται στη συγκεκριμένη socket.

> Οι σημερινοί web servers χρησιμοποιούν συχνά μόνο μια διεργασία αλλά δημιουργούν από 1 νήμα (threads) νέα socket σύνδεσης για κάθε πελάτη.